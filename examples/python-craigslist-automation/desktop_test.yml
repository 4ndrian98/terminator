name: Desktop Automation Python Test
description: Test Python engine with actual desktop automation

steps:
  - id: get_apps
    tool_name: get_applications
    arguments: {}

  - id: python_desktop_test
    tool_name: run_command
    arguments:
      engine: "python"
      run: |
        log("Testing desktop automation from Python...")

        # Get list of windows
        windows = await desktop.locator("role:Window").all()
        log(f"Found {len(windows)} windows")

        # Try to find notepad or another app
        notepad = await desktop.locator("role:Window|name:Notepad").first()

        if notepad:
            log("Found Notepad window")
            window_info = {
                "found": True,
                "app": "Notepad",
                "name": await notepad.name()
            }
        else:
            # Just report what we found
            window_names = []
            for w in windows[:5]:  # First 5 windows
                try:
                    name = await w.name()
                    if name:
                        window_names.append(name)
                except:
                    pass

            window_info = {
                "found": False,
                "window_count": len(windows),
                "sample_windows": window_names
            }

        return {
            "status": "success",
            "desktop_access": True,
            "window_info": window_info
        }

  - id: show_results
    tool_name: run_command
    arguments:
      engine: "javascript"
      run: |
        const apps = get_apps_result;
        const pythonTest = python_desktop_test_result;

        console.log("=== Desktop Automation Test Results ===");
        console.log(`Applications found: ${apps ? apps.length : 0}`);

        if (pythonTest && pythonTest.status === 'success') {
          console.log("âœ… Python desktop automation working!");
          console.log(`Desktop access: ${pythonTest.desktop_access}`);
          console.log(`Windows found: ${pythonTest.window_info.window_count || 0}`);

          if (pythonTest.window_info.sample_windows) {
            console.log("Sample windows:", pythonTest.window_info.sample_windows);
          }
        }

        return { test_passed: true };